{"ast":null,"code":"var _jsxFileName = \"/home/dbws/projects/resume-maker/resume-react-ui/src/components/pages/price/checkoutForm.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useState, useEffect, useMemo } from \"react\"; // import { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\n\nimport API from \"../../../API/index\";\nimport { useStripe, useElements, CardNumberElement, CardCvcElement, CardExpiryElement } from \"@stripe/react-stripe-js\";\nimport { setLocalStorageItem, getLocalStorageItem } from \"../../../utils/globals\";\nimport { auth } from \"../../../actions/auth\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst useOptions = () => {\n  _s();\n\n  // const fontSize = useResponsiveFontSize();\n  const options = useMemo(() => ({\n    style: {\n      base: {\n        // fontSize,\n        color: \"#424770\",\n        letterSpacing: \"0.025em\",\n        fontFamily: \"Source Code Pro, monospace\",\n        \"::placeholder\": {\n          color: \"#aab7c4\"\n        }\n      },\n      invalid: {\n        color: \"#9e2146\"\n      }\n    }\n  }));\n  return options;\n};\n\n_s(useOptions, \"UfleS4trXWGxzhzYTKqqYygmjCE=\");\n\nconst CheckoutForm = props => {\n  _s2();\n\n  const stripe = useStripe();\n  const elements = useElements();\n  const options = useOptions();\n  const [error, setError] = useState('');\n  const [paymentSuccess, setPaymentSuccess] = useState(false);\n\n  const handleSubmit = event => {\n    event.preventDefault();\n    stripe.createPaymentMethod({\n      type: \"card\",\n      card: elements.getElement(CardNumberElement)\n    }).then((res, err) => {\n      if (res && res.paymentMethod) {\n        try {\n          API.post('Payment_Post', {\n            amount: props.planDetail.calculated_price,\n            currencyType: props.planDetail.currencyType,\n            id: res.paymentMethod.id,\n            planId: props.planDetail.id\n          }, '', result => {\n            handleServerResponse(result.data);\n          });\n        } catch (error) {\n          setError(error);\n          console.log(error);\n        }\n      } else {\n        setError(error);\n        console.log(err);\n      }\n    });\n  };\n\n  const handleServerResponse = response => {\n    if (response.error) {\n      setError(error.message); // Show error from server on payment form\n    } else if (response.requires_action) {\n      // Use Stripe.js to handle the required card action\n      stripe.handleCardAction(response.payment_intent_client_secret).then((res, err) => {\n        if (err) {\n          console.log(err);\n          setError(err); // Show error from Stripe.js in payment form\n        } else {\n          try {\n            API.post('Payment_Post', {\n              payment_intent_id: res.paymentIntent.id\n            }, '', result => {\n              handleServerResponse(result.data);\n            });\n          } catch (error) {\n            setError(error);\n            console.log(error);\n          }\n        }\n      });\n    } else {\n      console.log(response);\n      setError(false);\n      let userDetail = getLocalStorageItem('userDetail');\n      userDetail.user['subscription'] = response.planDetail.subscription;\n      setLocalStorageItem('userDetail', userDetail);\n      setLocalStorageItem('expires', false);\n      setPaymentSuccess(response);\n      props.auth(); // alert(\"Payment Success\" + JSON.stringify(response))\n    }\n  };\n\n  if (paymentSuccess) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"Payment Successfull\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 35\n      }, this), \"Transaction Detail \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 28\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\" ID : \", paymentSuccess.intent.id]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 54\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\" Amount : \", paymentSuccess.intent.currency, \" \", paymentSuccess.intent.amount / 100]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }, this), \"Subscription Detail \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 29\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\" Name : \", paymentSuccess.planDetail.subscription.name]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 75\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\" Validity : \", paymentSuccess.planDetail.subscription.validity, \" Months\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 90\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\" Expires : \", paymentSuccess.planDetail.subscription.expires]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 81\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }, this);\n  }\n\n  console.log(props);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"col-6 shadow align-items-center mt-5 mb-5 pt-5\",\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Card number\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"card-element\",\n        className: \"form-control form-control-payment\",\n        children: /*#__PURE__*/_jsxDEV(CardNumberElement, {\n          className: \"test\",\n          options: options,\n          onReady: () => {\n            console.log(\"CardNumberElement [ready]\");\n          },\n          onChange: event => {\n            console.log(\"CardNumberElement [change]\", event);\n          },\n          onBlur: () => {\n            console.log(\"CardNumberElement [blur]\");\n          },\n          onFocus: () => {\n            console.log(\"CardNumberElement [focus]\");\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Expiration date\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"card-element\",\n        className: \"form-control form-control-payment\",\n        children: /*#__PURE__*/_jsxDEV(CardExpiryElement, {\n          options: options,\n          onReady: () => {\n            console.log(\"CardNumberElement [ready]\");\n          },\n          onChange: event => {\n            console.log(\"CardNumberElement [change]\", event);\n          },\n          onBlur: () => {\n            console.log(\"CardNumberElement [blur]\");\n          },\n          onFocus: () => {\n            console.log(\"CardNumberElement [focus]\");\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"CVC\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"card-element\",\n        className: \"form-control form-control-payment\",\n        children: /*#__PURE__*/_jsxDEV(CardCvcElement, {\n          options: options,\n          onReady: () => {\n            console.log(\"CardNumberElement [ready]\");\n          },\n          onChange: event => {\n            console.log(\"CardNumberElement [change]\", event);\n          },\n          onBlur: () => {\n            console.log(\"CardNumberElement [blur]\");\n          },\n          onFocus: () => {\n            console.log(\"CardNumberElement [focus]\");\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"card-element\",\n        className: \"col-md-12 form-control-payment\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          style: {\n            \"padding\": \"9px\"\n          },\n          className: \" form-control btn btn-primary\",\n          type: \"submit\",\n          disabled: !stripe,\n          children: [\"Pay \", props.planDetail.currencyType, \" \", props.planDetail.calculated_price]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 11\n        }, this), error && /*#__PURE__*/_jsxDEV(\"span\", {\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 142,\n    columnNumber: 5\n  }, this);\n};\n\n_s2(CheckoutForm, \"9XYCmtm7TgSTyyqutpkZKjoxfhk=\", false, function () {\n  return [useStripe, useElements, useOptions];\n});\n\n_c = CheckoutForm;\n\nconst mapStateToProps = state => ({\n  userDetail: state.user.userDetail\n});\n\nconst mapDispatchToProps = {\n  auth\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(CheckoutForm);\n\nvar _c;\n\n$RefreshReg$(_c, \"CheckoutForm\");","map":{"version":3,"sources":["/home/dbws/projects/resume-maker/resume-react-ui/src/components/pages/price/checkoutForm.js"],"names":["React","useState","useEffect","useMemo","API","useStripe","useElements","CardNumberElement","CardCvcElement","CardExpiryElement","setLocalStorageItem","getLocalStorageItem","auth","useOptions","options","style","base","color","letterSpacing","fontFamily","invalid","CheckoutForm","props","stripe","elements","error","setError","paymentSuccess","setPaymentSuccess","handleSubmit","event","preventDefault","createPaymentMethod","type","card","getElement","then","res","err","paymentMethod","post","amount","planDetail","calculated_price","currencyType","id","planId","result","handleServerResponse","data","console","log","response","message","requires_action","handleCardAction","payment_intent_client_secret","payment_intent_id","paymentIntent","userDetail","user","subscription","intent","currency","name","validity","expires","mapStateToProps","state","mapDispatchToProps","connect"],"mappings":"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","sourcesContent":["import React , {useState, useEffect , useMemo} from \"react\";\n// import { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport API from \"../../../API/index\"\nimport {\n  useStripe,\n  useElements,\n  CardNumberElement,\n  CardCvcElement,\n  CardExpiryElement\n} from \"@stripe/react-stripe-js\";\nimport { setLocalStorageItem , getLocalStorageItem } from \"../../../utils/globals\";\nimport { auth } from \"../../../actions/auth\";\n\nconst useOptions = () => {\n  // const fontSize = useResponsiveFontSize();\n  const options = useMemo(\n    () => ({\n      style: {\n        base: {\n          // fontSize,\n          color: \"#424770\",\n          letterSpacing: \"0.025em\",\n          fontFamily: \"Source Code Pro, monospace\",\n          \"::placeholder\": {\n            color: \"#aab7c4\"\n          }\n        },\n        invalid: {\n          color: \"#9e2146\"\n        }\n      }\n    })\n  );\n\n  return options;\n};\n\nconst CheckoutForm = (props) => {\n  const stripe = useStripe();\n  const elements = useElements();\n  const options = useOptions();\n\n  const [error , setError] = useState('');\n  const [paymentSuccess , setPaymentSuccess] = useState(false);\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    stripe.createPaymentMethod({\n      type: \"card\",\n      card: elements.getElement(CardNumberElement),\n    }).then((res , err) => {\n        if (res && res.paymentMethod) {\n            try {\n              API.post('Payment_Post',\n                {\n                  amount: props.planDetail.calculated_price,\n                  currencyType: props.planDetail.currencyType,\n                  id: res.paymentMethod.id,\n                  planId : props.planDetail.id\n                }, '',\n                (result) => {\n                  \n                  handleServerResponse(result.data);\n                }\n              )\n            } catch (error) {\n              setError(error)\n              console.log(error)\n            }\n            \n          } else {\n            setError(error)\n            console.log(err);\n          }\n    });\n\n    \n  };\n\n  const handleServerResponse = (response) => {\n    if (response.error) {\n      setError(error.message)\n      // Show error from server on payment form\n    } else if (response.requires_action) {\n      // Use Stripe.js to handle the required card action\n        stripe.handleCardAction(response.payment_intent_client_secret).then((res , err) => {\n\n          if (err) {\n            console.log(err);\n            setError(err);\n            // Show error from Stripe.js in payment form\n          } else {\n            \n            try {\n              API.post('Payment_Post',\n                {\n                  payment_intent_id : res.paymentIntent.id\n                }, '',\n                (result) => {\n                  handleServerResponse(result.data);\n                }\n              )\n            } catch (error) {\n              setError(error)\n              console.log(error)\n            }\n          }\n        });\n  \n    } else {\n      console.log(response);\n      setError(false)\n      let userDetail = getLocalStorageItem('userDetail');\n      userDetail.user['subscription'] = response.planDetail.subscription;\n      setLocalStorageItem('userDetail' , userDetail );\n      setLocalStorageItem('expires' , false)  \n      setPaymentSuccess(response);\n      props.auth()\n\n      // alert(\"Payment Success\" + JSON.stringify(response))\n    }\n  }\n  if(paymentSuccess){\n    return (\n      <div>\n        <b>Payment Successfull</b><br></br>\n        Transaction Detail <br></br>\n        <span> ID : {paymentSuccess.intent.id}</span><br></br>\n        <span> Amount : {paymentSuccess.intent.currency} {paymentSuccess.intent.amount/100}</span>\n        <br></br>\n        Subscription Detail <br></br>\n        <span> Name : {paymentSuccess.planDetail.subscription.name}</span><br></br>\n        <span> Validity : {paymentSuccess.planDetail.subscription.validity} Months</span><br></br>\n        <span> Expires : {paymentSuccess.planDetail.subscription.expires}</span><br></br>\n        <br></br>\n        \n      </div>\n    )\n  }\n  console.log(props)\n  return (\n    <div className=\"col-6 shadow align-items-center mt-5 mb-5 pt-5\">\n\n    <form onSubmit={handleSubmit}>\n        <label>\n          Card number\n          </label>\n          <div id=\"card-element\" className=\"form-control form-control-payment\">\n\n            <CardNumberElement\n              className=\"test\"\n              options={options}\n              onReady={() => {\n                console.log(\"CardNumberElement [ready]\");\n              }}\n              onChange={event => {\n                console.log(\"CardNumberElement [change]\", event);\n              }}\n              onBlur={() => {\n                console.log(\"CardNumberElement [blur]\");\n              }}\n              onFocus={() => {\n                console.log(\"CardNumberElement [focus]\");\n              }}\n            />\n          </div>\n        <label>\n          Expiration date\n          </label>\n          <div id=\"card-element\" className=\"form-control form-control-payment\">\n\n            <CardExpiryElement\n              options={options}\n              onReady={() => {\n                console.log(\"CardNumberElement [ready]\");\n              }}\n              onChange={event => {\n                console.log(\"CardNumberElement [change]\", event);\n              }}\n              onBlur={() => {\n                console.log(\"CardNumberElement [blur]\");\n              }}\n              onFocus={() => {\n                console.log(\"CardNumberElement [focus]\");\n              }}\n            />\n        </div>\n        <label>\n          CVC\n        </label>\n        <div id=\"card-element\" className=\"form-control form-control-payment\">\n\n          <CardCvcElement\n            options={options}\n            onReady={() => {\n              console.log(\"CardNumberElement [ready]\");\n            }}\n            onChange={event => {\n              console.log(\"CardNumberElement [change]\", event);\n            }}\n            onBlur={() => {\n              console.log(\"CardNumberElement [blur]\");\n            }}\n            onFocus={() => {\n              console.log(\"CardNumberElement [focus]\");\n            }}\n          />\n        </div>\n        <label></label>\n        <div id=\"card-element\" className=\"col-md-12 form-control-payment\">\n\n          <button style={{\"padding\" : \"9px\"}} className=\" form-control btn btn-primary\" type=\"submit\" disabled={!stripe}>\n            Pay {props.planDetail.currencyType} {props.planDetail.calculated_price}\n          </button>\n          {error && <span>{error}</span>}\n        </div>\n    </form>\n    </div>\n    \n  );\n};\n\nconst mapStateToProps = ( state ) => ( {\n  userDetail: state.user.userDetail\n} );\n\nconst mapDispatchToProps = {\n  auth,\n};\n\nexport default connect( mapStateToProps, mapDispatchToProps )( CheckoutForm );\n"]},"metadata":{},"sourceType":"module"}